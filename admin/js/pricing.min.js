document.addEventListener("DOMContentLoaded",function(){HMA.initPricing()});HotelBookingModuleAdmin.prototype.initPricing=function(){this.buildRoomsList();var b={};for(var a in this.prices){b[a]=this.prices[a].price+" руб"}this.container=$("#pricing-container");this.container.calendarWidget({onselectday:this.onSelectDate.bind(this),urlParams:["action","from","to","room_id"],tdAditionalContent:b})};HotelBookingModuleAdmin.prototype.onSelectDate=function(c,a){var f=tippy(a);var e=document.createElement("div");var b=document.createElement("input");b.className="form-control";b.setAttribute("placeholder","цена");b.style.width="70%";b.style.cssFloat="left";b.type="number";if(this.prices[c]){b.value=this.prices[c]}b.dataDate=c;b.dataCell=a;e.appendChild(b);var d=document.createElement("button");d.className="btn btn-success";d.setAttribute("style","float: right; width: 50px; height: 40px;");e.appendChild(d);d.onclick=this.onChangePrice.bind(this,b,f);d.innerHTML='<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAFYSURBVFhH7dO7S8NAHMDxuPgf+C/ZBJNW8DGLbuLSv8BJappU0MXXooNuDi7OUtBegkGUxkVFRJcKgtA88FHPRu8npWhrTq534n3h4F4cHwhRZDLZHypTQDkF4z6yFKushZZUs9LIlpxV4ZAJbmLlODi6ifHU+mkgFBJwfu0JXz284rO7Zzy5dhIYNlomV/jVjkuGdxvj8UU31C2U/7jFKYmjTeJokzja/h9OnSsPkOmvYoLTipURrYjiQfNAJ1tUMcMNLzjhtlPDhu1GqnVokKNUsfms82g0wZUv6+8P7p/XqZDMfgjddnamN6rRxX3j8+G0SGa4pLHZan+u5Ozlt/ywHdncD7shmeIgWmRPcFBaZE9x0E+RXHBQN2QTsMsNB3VCzmz6j1xx0HfI1uHxwkGdkB5vHPQV0hMFB7Ui3etILBwESM1EL8LhoASZKaAhspTJZHxTlDc17GsTXkWYNAAAAABJRU5ErkJggg==" style="width: 30px;">';f.set({content:e,trigger:"click",interactive:true});f.show()};HotelBookingModuleAdmin.prototype.onChangePrice=function(a,c){var b=a.value?a.value+" руб":"";this.container.calendarWidget("setAdditionalContent",a.dataDate,b);this.post({action:"changeprice",room:msweb.urlGet("room_id"),date:a.dataDate,price:a.value});this.prices[a.dataDate]=a.value;c.hide();c.destroy()};HotelBookingModuleAdmin.prototype.buildRoomsList=function(){var a=$("#rooms-container");if(!a.length){return}for(var c in this.rooms){var b='<div class="row list-item"><div class="col-sm-8 list-item-section"><b>'+this.rooms[c].type;if(this.rooms[c].status=="draft"){b+=" (черновик)"}b+='</b></div><div class="col-sm-2 text-center pt-2"><button class="btn-success" onclick="HMA.editRoomPrice('+c+')">Редактирвать</button></div></div>';a.append(b)}};HotelBookingModuleAdmin.prototype.editRoomPrice=function(a){window.location.href=hotelBookingModuleUrl+"/admin/pricing/?action=pricing&room_id="+a};HotelBookingModuleAdmin.prototype.submitPricePeriod=function(){var c=$("#date-from").val();var b=$("#date-to").val();var a=$("#price").val();this.post({action:"submitPricePeriod",from:c,to:b,price:a,roomId:msweb.urlGet("room_id")},function(e){window.location.reload()})};